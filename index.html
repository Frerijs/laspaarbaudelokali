<!DOCTYPE html>
<html>
<head>
    <title>LAS Apstrāde pārlūkā ar PDAL.js</title>
    <script src="https://unpkg.com/pdal"></script>
</head>
<body>
    <h2>LAS faila apstrāde ar WebAssembly</h2>
    <input type="file" id="lasFile" accept=".las">
    <button onclick="processLAS()">Apstrādāt LAS</button>
    <pre id="output"></pre>

    <script>
        async function processLAS() {
            let lasFile = document.getElementById("lasFile").files[0];
            if (!lasFile) {
                document.getElementById("output").innerText = "Lūdzu, augšupielādējiet LAS failu!";
                return;
            }

            let reader = new FileReader();
            reader.onload = async function(event) {
                let buffer = event.target.result;

                // Izveido PDAL WebAssembly vidi
                let pdal = await PDAL();
                let pipeline = {
                    "pipeline": [
                        { "type": "readers.las", "filename": buffer },
                        { "type": "filters.sort", "dimension": "Z" },
                        { "type": "writers.text", "filename": "output.txt" }
                    ]
                };

                let result = pdal.runPipeline(JSON.stringify(pipeline));
                document.getElementById("output").innerText = "Apstrādāts LAS fails: " + JSON.stringify(result);
            };

            reader.readAsArrayBuffer(lasFile);
        }
    </script>
</body>
</html>
